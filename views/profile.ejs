<%- include("partials/header"); -%>
<!-- Custom styles -->
<!-- <link rel="stylesheet" href="/css/main.css"> -->
<link rel="stylesheet" href="/css/account.css">
</head>

<body id="bootstrap-overrides">
  <%- include("partials/navbar"); -%>

  <main role="main" class="container-fluid">

    <div class="row">
      <div class="col-md-3 col-12">
        <%- include("partials/sidenav"); -%>
      </div>
      <div class="col-md-9 col-12">
        <div class="tab-content">
          <div>
            <h3>회원 정보</h3>
          </div>
          <div class="tab-subcontent">
            <% if (sess.message) { %>
            <div class="alert alert-warning" role="alert">
              <%= sess.message %>
            </div>
            <%}%>
            <form class="info-wrap" method="post" action="/profile">
              <div class="row">
                <div class="col-12 text-center">
                  <img src="/images/user-default-pic.png" class="rounded-circle" width="140px"/>
                </div>
                <div class="col-12 text-center">
                    <a class="btn btn-outline-dark mt-3 mb-4 mx-2" href="/my-cart"><i class="fas fa-shopping-cart"></i> 쇼핑카트</a>
                    <a class="btn btn-outline-dark mt-3 mb-4 mx-2" href="/my-wishlist"><i class="fas fa-heart"></i> 위시리스트</a>
                </div>

                <div class="col-3 mb-3">
                  아이디
                </div>
                <div class="col-9 mb-3">
                  <%= user_id %>
                </div>

          <div class="col-3 mb-3">
            성명
          </div>
          <div class="col-9 mb-3">
            <input name="fullname" type="" class="form-control" placeholder="성명" maxlength="50" value="<%= data[0].fullname %>" required />
          </div>

          <div class="col-3 mb-3">
            현재 비밀번호
          </div>
          <div class="col-9 mb-3">
            <div class="input-group">
              <input name="password" type="password" id="password" placeholder="정보 변경할 때마다 입력 필수" class="form-control" required />
              <div class="input-group-append">
                <div id="show_change_pw" class="btn btn-danger btn-block">변경</div>
              </div>
            </div>
          </div>

          <div class="col-3 mb-3 npw d-none">
            새 비밀번호
          </div>
          <div class="col-9 mb-3 npw d-none">
            <input name="new_password" type="password" id="new_password" class="form-control" maxlength="50" />
          </div>

          <div class="col-3 mb-3 npw-c d-none">
            새 비밀번호 확인
          </div>
          <div class="col-9 mb-3 npw-c d-none">
            <input name="new_password_confirm" type="password" id="new_password_confirm" class="form-control" maxlength="50" />
          </div>

          <div class="col-3 mb-3">
            성별
          </div>
          <div class="col-9 mb-3">
            <select id="gender" name="gender" class="form-control">
              <option value="" <%= data[0].gender == "" ? "selected" : ""; %>>성별 선택</option>
              <option value="M" <%= data[0].gender == "M" ? "selected" : ""; %>>남자</option>
              <option value="F" <%= data[0].gender == "F" ? "selected" : ""; %>>여자</option>
            </select>
          </div>

          <div class="col-3 mb-3">
            생년월일
          </div>
          <div class="col-9 mb-3">
            <div class="row">
              <div class="col-4 dob-pr-rm pr-0">
                <input type="" id="yy" name="yy" placeholder="년(4자)" class="form-control" value="<%= data[0].birth != "0000-00-00" ? data[0].birth.getFullYear() : "" %>" maxlength="4">
              </div>
              <div class="col-4 dob-pr-rm pr-0">
                <select id="mm" name="mm" class="form-control" aria-label="월">
                  <% if (data[0].birth != "0000-00-00") { %>
                  <option value="" <%= data[0].birth.getMonth() == "" ? "selected" : "" %>>월</option>
                  <option value="01" <%= data[0].birth.getMonth() == "00" ? "selected" : "" %>>1</option>
                  <option value="02" <%= data[0].birth.getMonth() == "1" ? "selected" : "" %>>2</option>
                  <option value="03" <%= data[0].birth.getMonth() == "2" ? "selected" : "" %>>3</option>
                  <option value="04" <%= data[0].birth.getMonth() == "3" ? "selected" : "" %>>4</option>
                  <option value="05" <%= data[0].birth.getMonth() == "4" ? "selected" : "" %>>5</option>
                  <option value="06" <%= data[0].birth.getMonth() == "5" ? "selected" : "" %>>6</option>
                  <option value="07" <%= data[0].birth.getMonth() == "6" ? "selected" : "" %>>7</option>
                  <option value="08" <%= data[0].birth.getMonth() == "7" ? "selected" : "" %>>8</option>
                  <option value="09" <%= data[0].birth.getMonth() == "8" ? "selected" : "" %>>9</option>
                  <option value="10" <%= data[0].birth.getMonth() == "9" ? "selected" : "" %>>10</option>
                  <option value="11" <%= data[0].birth.getMonth() == "10" ? "selected" : "" %>>11</option>
                  <option value="12" <%= data[0].birth.getMonth() == "11" ? "selected" : "" %>>12</option>
                  <%} else {%>
                  <option value="" selected>월</option>
                  <option value="01">1</option>
                  <option value="02">2</option>
                  <option value="03">3</option>
                  <option value="04">4</option>
                  <option value="05">5</option>
                  <option value="06">6</option>
                  <option value="07">7</option>
                  <option value="08">8</option>
                  <option value="09">9</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                  <%}%>
                      </select>
                    </div>
                    <div class="col-4 dob-pr-rm">
                      <input type="" class="form-control" id="dd" name="dd" placeholder="일" value="<%= data[0].birth != "0000-00-00" ? data[0].birth.getDate() : "" %>" maxlength="2">
              </div>
            </div>
          </div>

          <div class="col-3 mb-3">
            이메일
          </div>
          <div class="col-9 mb-3">
            <input name="email" type="email" id="email" class="form-control" placeholder="이메일" maxlength="50" value="<%= data[0].email %>" required>
          </div>

          <div class="col-3 mb-3">
            연락처
          </div>
          <div class="col-9 mb-3">
            <input name="no_tel" type="tel" id="no_tel" class="form-control" placeholder="전화번호" maxlength="20" value="<%= data[0].phone %>" required>
          </div>

          <div class="col-3 mb-4">
            헤이즐페이 머니
          </div>
          <div class="col-9 mb-4">
            <%= data[0].s_money ? formatNum(data[0].s_money) : '0' %> 원 <a href="/account/payment-method" class="btn btn-link btn-sm">(충전)</a>
          </div>
        </div>

        <div class="col-12 text-center">
          <input type="submit" class="btn btn-info save-acc-info-btn" value="변경 저장" />
        </div>
        </form>

      </div>
    </div>
    </div>
    <div class="col-12">
      <%- include("partials/copyright"); -%>
    </div>
    </div>
  </main>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
    $('#show_change_pw').on('click', function() {
      $('.npw').removeClass('d-none');
      $('.npw-c').removeClass('d-none');

      if ($('#show_change_pw').text() == "변경") {
        $('#show_change_pw').text("취소");
        $('.npw').removeClass('d-none');
        $('.npw-c').removeClass('d-none');
        $('#show_change_pw').removeClass('btn-danger');
        $('#show_change_pw').addClass('btn-warning');
      } else {
        $('#show_change_pw').text("변경");
        $('.npw').addClass('d-none');
        $('.npw-c').addClass('d-none');
        $('#show_change_pw').addClass('btn-danger');
        $('#show_change_pw').removeClass('btn-warning');
      }
    });
  </script>
  <%- include("partials/footer"); -%>
