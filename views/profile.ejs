<%- include("partials/header"); -%>
<!-- Custom styles -->
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/profile.css">
</head>

<body id="bootstrap-overrides">
  <%- include("partials/navbar"); -%>

  <main role="main" class="container-fluid">

    <div class="side-navbar">
      <h4>내 계정</h4>
      <ul>
        <li><a href="profile/account-info" class="nav-item">회원정보</a></li>
        <li><a href="profile/manage-address" class="nav-item">주소록 관리</a></li>
        <li><a href="profile/purchase-history" class="nav-item">구매목록</a></li>
        <li><a href="profile/payment-method" class="nav-item">결제수단</a></li>
        <li><a href="/logout"><i class="fas fa-sign-out-alt"></i> 로그아웃</a></li>
      </ul>
    </div>

    <div class="tab-content">
      <div>
        <h3>회원 정보</h3>
      </div>
      <div class="tab-subcontent">
        <form class="info-wrap" method="post" action="/profile">
          <% if (message) { %>
          <div class="alert alert-warning" role="alert">
            <%= message %>
          </div>
          <%}%>
          <table>
            <tr class="center">
              <td class="center-content" colspan="2"><img src="images/user-default-pic.png" class="rounded-circle" width="140" height="140" /></td>
            </tr>
            <tr>
              <td class="center-content" colspan="2">
                <a class="btn btn-outline-dark" href="/my-cart"><i class="fas fa-shopping-cart"></i> 쇼핑카트</a>
                <a class="btn btn-outline-dark" href="/my-wishlist"><i class="fas fa-heart"></i> 위시리스트</a>
                <a class="btn btn-outline-dark" href="/recent-viewed-product"><i class="fas fa-history"></i> 최근본상품</a>
              </td>
            </tr>
            <tr>
              <td width="150px">아이디</td>
              <td><%= user_id %></td>
            </tr>
            <tr>
              <td>성명</td>
              <td><input name="fullname" type="text" class="form-control" placeholder="성명" maxlength="50" value="<%= data[0].fullname %>" required /></td>
            </tr>
            <tr>
              <td>현재 비밀번호</td>
              <td>
                <div class="row">
                  <div class="col-sm-10">
                    <input name="password" type="password" id="password" placeholder="정보 변경할 때마다 입력 필수" class="form-control" required />
                  </div>
                  <div class="col-sm-2">
                    <span id="show_change_pw" class="btn btn-danger">변경</span>
                    <span id="hide_change_pw" class="btn btn-warning" style="display: none;">취소</span>
                  </div>
                </div>
              </td>
            </tr>
            <tr id="npw" style="display: none">
              <td>새 비밀번호</td>
              <td><input name="new_password" type="password" id="new_password" class="form-control" minlength="6" maxlength="50" /></td>
            </tr>
            <tr id="npw_c" style="display: none">
              <td> 새 비밀번호 확인</td>
              <td><input name="new_password_confirm" type="password" id="new_password_confirm" class="form-control" minlength="6" maxlength="50" /></td>
            </tr>
            <tr>
              <td>성별</td>
              <td>
                <select id="gender" name="gender" class="form-control" style="width: 30%; float:left;">
                  <option value="" <%= data[0].gender == "" ? "selected" : ""; %>>성별 선택</option>
                  <option value="M" <%= data[0].gender == "M" ? "selected" : ""; %>>남자</option>
                  <option value="F" <%= data[0].gender == "F" ? "selected" : ""; %>>여자</option>
                </select>
              </td>
            </tr>
            <tr>
              <td>생년월일</td>
              <td>
                <div class="row">
                  <div class="col-sm-4 dob-pr-rm">
                    <input type="text" id="yy" name="yy" placeholder="년(4자)" class="form-control" value="<%= data[0].birth != "0000-00-00" ? data[0].birth.getFullYear() : "" %>" maxlength="4">
                  </div>
                  <div class="col-sm-4 dob-pr-rm">
                    <select id="mm" name="mm" class="form-control" aria-label="월">
                      <% if (data[0].birth != "0000-00-00") { %>
                        <option value="" <%= data[0].birth.getMonth() == "" ? "selected" : "" %>>월</option>
                        <option value="01" <%= data[0].birth.getMonth() == "00" ? "selected" : "" %>>1</option>
                        <option value="02" <%= data[0].birth.getMonth() == "1" ? "selected" : "" %>>2</option>
                        <option value="03" <%= data[0].birth.getMonth() == "2" ? "selected" : "" %>>3</option>
                        <option value="04" <%= data[0].birth.getMonth() == "3" ? "selected" : "" %>>4</option>
                        <option value="05" <%= data[0].birth.getMonth() == "4" ? "selected" : "" %>>5</option>
                        <option value="06" <%= data[0].birth.getMonth() == "5" ? "selected" : "" %>>6</option>
                        <option value="07" <%= data[0].birth.getMonth() == "6" ? "selected" : "" %>>7</option>
                        <option value="08" <%= data[0].birth.getMonth() == "7" ? "selected" : "" %>>8</option>
                        <option value="09" <%= data[0].birth.getMonth() == "8" ? "selected" : "" %>>9</option>
                        <option value="10" <%= data[0].birth.getMonth() == "9" ? "selected" : "" %>>10</option>
                        <option value="11" <%= data[0].birth.getMonth() == "10" ? "selected" : "" %>>11</option>
                        <option value="12" <%= data[0].birth.getMonth() == "11" ? "selected" : "" %>>12</option>
                      <%} else {%>
                        <option value="" selected>월</option>
                        <option value="01">1</option>
                        <option value="02">2</option>
                        <option value="03">3</option>
                        <option value="04">4</option>
                        <option value="05">5</option>
                        <option value="06">6</option>
                        <option value="07">7</option>
                        <option value="08">8</option>
                        <option value="09">9</option>
                        <option value="10">10</option>
                        <option value="11">11</option>
                        <option value="12">12</option>
                      <%}%>

                    </select>
                  </div>
                  <div class="col-sm-4 dob-pr-rm">
                    <input type="text" class="form-control" id="dd" name="dd" placeholder="일" value="<%= data[0].birth != "0000-00-00" ? data[0].birth.getDate() : "" %>" maxlength="2">
                  </div>
                </div>
              </td>
            </tr>
            <tr>
              <td>이메일</td>
              <td><input name="email" type="email" id="email" class="form-control" placeholder="이메일" maxlength="50" value="<%= data[0].email %>" required></td>
            </tr>
            <tr>
              <td>연락처</td>
              <td><input name="no_tel" type="tel" id="no_tel" class="form-control" placeholder="전화번호" maxlength="20" value="<%= data[0].phone %>" required></td>
            </tr>
          </table>

          <div class="center-content btn-edit">
            <input type="submit" class="btn btn-info center-content" value="변경 저장" />
          </div>

        </form>
      </div>
    </div>
  </main>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script>
      $('#show_change_pw').on('click', function() {
        $('#npw').toggle();
        $('#npw_c').toggle();
        $('#show_change_pw').toggle();
        $('#hide_change_pw').toggle();
      });

      $('#hide_change_pw').on('click', function() {
        $('#npw').toggle();
        $('#npw_c').toggle();
        $('#show_change_pw').toggle();
        $('#hide_change_pw').toggle();
      });
  </script>
  <%- include("partials/footer"); -%>
